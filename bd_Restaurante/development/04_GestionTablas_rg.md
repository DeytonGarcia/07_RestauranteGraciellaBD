# Esquema de Base de Datos para Restaurante

## Tabla `person`
### Descripción
Almacena información sobre las personas en el sistema. Puede incluir tanto clientes como empleados del restaurante. Esta tabla es fundamental para identificar a los usuarios que interactúan con el sistema.

### Estructura

```sql
CREATE TABLE person (
    person_id INTEGER GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) PRIMARY KEY,  -- Identificador único para cada persona
    person_type VARCHAR2(50) NOT NULL,  -- Tipo de persona: 'cliente', 'empleado', etc.
    names VARCHAR2(100) NOT NULL CHECK (  -- Nombres de la persona, con validación para evitar caracteres inválidos
        REGEXP_LIKE(names, '^[A-Za-zÁáÉéÍíÓóÚúÑñ]+(\s+[A-Za-zÁáÉéÍíÓóÚúÑñ]+)*$')
    ),
    surnames VARCHAR2(100) NOT NULL CHECK (  -- Apellidos de la persona, con validación similar
        REGEXP_LIKE(surnames, '^[A-Za-zÁáÉéÍíÓóÚúÑñ]+(\s+[A-Za-zÁáÉéÍíÓóÚúÑñ]+)*$')
    ),
    address VARCHAR2(200),  -- Dirección de la persona
    phone VARCHAR2(15),  -- Número de teléfono de la persona
    email VARCHAR2(100),  -- Correo electrónico de la persona
    date_of_birth DATE,  -- Fecha de nacimiento
    document_type VARCHAR2(10),  -- Tipo de documento de identidad (ej. DNI, pasaporte)
    document_number CHAR(20) NOT NULL,  -- Número de documento de identidad
    status VARCHAR2(10) DEFAULT 'ACTIVE' CHECK (status IN ('ACTIVE', 'INACTIVE'))  -- Estado de la persona
);
```

## Tabla `menu`
### Descripción
Define los platos disponibles en el restaurante, incluyendo su nombre, descripción, precios y estado. Esta tabla permite gestionar la oferta gastronómica del establecimiento.

### Estructura

```sql
CREATE TABLE menu (
    menu_id INTEGER GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) PRIMARY KEY,  -- Identificador único para cada plato
    dish_name VARCHAR2(100) NOT NULL,  -- Nombre del plato
    description VARCHAR2(255),  -- Breve descripción del plato
    registration_date DATE DEFAULT SYSDATE,  -- Fecha en que se registró el plato
    entrance VARCHAR2(100),  -- Nombre del plato de entrada
    second_course VARCHAR2(100),  -- Nombre del segundo plato
    dessert VARCHAR2(100),  -- Nombre del postre
    unit_price NUMBER(10, 2) CHECK (unit_price > 0),  -- Precio unitario del plato
    amount NUMBER,  -- Cantidad disponible del plato
    state VARCHAR2(20) DEFAULT 'ACTIVE' CHECK (state IN ('ACTIVE', 'INACTIVE'))  -- Estado del plato
);
```

## Tabla `orders`
### Descripción
Registra las órdenes realizadas en el restaurante, asociando a los clientes con los camareros y las mesas. Esta tabla es esencial para el seguimiento de las ventas y el servicio al cliente.

### Estructura

```sql
CREATE TABLE orders (
    order_id INTEGER GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) PRIMARY KEY,  -- Identificador único para cada orden
    client_id NUMBER REFERENCES person(person_id),  -- Referencia al cliente que realiza la orden
    waiter_id NUMBER REFERENCES person(person_id),  -- Referencia al camarero que atiende la orden
    table_number INTEGER,  -- Número de la mesa asociada a la orden
    order_date DATE DEFAULT SYSDATE,  -- Fecha de creación de la orden
    total_amount NUMBER(10, 2) DEFAULT 0,  -- Monto total de la orden
    payment_status VARCHAR2(20) DEFAULT 'PENDIENTE' CHECK (payment_status IN ('PENDIENTE', 'PAGADO', 'CANCELADO')),  -- Estado del pago
    payment_type VARCHAR2(50),  -- Tipo de pago (ej. efectivo, tarjeta)
    order_status VARCHAR2(20) DEFAULT 'PENDIENTE' CHECK (order_status IN ('PENDIENTE', 'EN_PROCESO', 'COMPLETADO', 'CANCELADO')),  -- Estado de la orden
    notes VARCHAR2(200),  -- Notas adicionales sobre la orden
    status VARCHAR2(10) DEFAULT 'ACTIVE' CHECK (status IN ('ACTIVE', 'INACTIVE'))  -- Estado de la orden
);
```

## Tabla `order_detail`
### Descripción
Detalla los elementos individuales de cada orden, permitiendo un desglose de los platos solicitados y sus cantidades. Esto es crucial para la gestión de inventarios y la facturación.

### Estructura

```sql
CREATE TABLE order_detail (
    detail_id INTEGER GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) PRIMARY KEY,  -- Identificador único para cada detalle de orden
    order_id NUMBER REFERENCES orders(order_id) ON DELETE CASCADE,  -- Referencia a la orden en la tabla `orders`
    menu_id NUMBER REFERENCES menu(menu_id),  -- Referencia al plato en la tabla `menu`
    quantity NUMBER DEFAULT 1,  -- Cantidad de un plato específico en la orden
    unit_price NUMBER(10, 2),  -- Precio unitario del plato
    subtotal NUMBER(10, 2),  -- Subtotal para la cantidad especificada
    item_status VARCHAR2(20) DEFAULT 'PENDIENTE' CHECK (item_status IN ('PENDIENTE', 'PREPARANDO', 'SERVIDO', 'CANCELADO')),  -- Estado del elemento
    notes VARCHAR2(200),  -- Notas adicionales sobre el detalle
    status VARCHAR2(10) DEFAULT 'ACTIVE' CHECK (status IN ('ACTIVE', 'INACTIVE'))  -- Estado del detalle
);
```

## Tabla `tables`
### Descripción
Almacena información sobre las mesas del restaurante, incluyendo su número y capacidad. Esta tabla ayuda a gestionar la disponibilidad de las mesas para los clientes.

### Estructura

```sql
CREATE TABLE tables (
    table_id INTEGER GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) PRIMARY KEY,  -- Identificador único para cada mesa
    table_number INTEGER UNIQUE,  -- Número de la mesa
    capacity INTEGER,  -- Capacidad máxima de la mesa
    status VARCHAR2(20) DEFAULT 'DISPONIBLE' CHECK (status IN ('DISPONIBLE', 'OCUPADO', 'RESERVADO')),  -- Estado de la mesa
    active_status VARCHAR2(10) DEFAULT 'ACTIVE' CHECK (active_status IN ('ACTIVE', 'INACTIVE'))  -- Indica si la mesa está activa o inactiva
);
```

## Tabla `reservation_detail`
### Descripción
Detalla los elementos específicos de una reserva, permitiendo gestionar los platos solicitados y sus cantidades para las reservas. Esto es útil para planificar el menú de eventos o reservas especiales.

### Estructura

```sql
CREATE TABLE reservation_detail (
    detail_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,  -- Identificador único para cada detalle de reserva
    amount NUMBER,  -- Cantidad de platos solicitados
    menu_requested VARCHAR2(100) NOT NULL,  -- Nombre del menú solicitado
    menu_type NUMBER,  -- Tipo de menú (ej. vegetariano, especial)
    sub_total NUMBER(10, 2) CHECK (sub_total >= 0)  -- Subtotal del detalle de la reserva
);
```

## Tabla `reservations`
### Descripción
Registra las reservas realizadas en el restaurante, incluyendo información sobre el cliente, la fecha y hora de la reserva, y los detalles específicos de la misma. Esto permite gestionar la planificación de eventos y la disponibilidad.

### Estructura

```sql
CREATE TABLE reservations (
    reservation_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,  -- Identificador único para cada reserva
    client_id NUMBER REFERENCES person(person_id) ON DELETE CASCADE,  -- Referencia al cliente que realiza la reserva
    reservation_date DATE NOT NULL,  -- Fecha de la reserva
    reservation_time TIMESTAMP NOT NULL,  -- Hora de la reserva
    detalle_reserva_id_detalleReserva NUMBER REFERENCES reservation_detail(detail_id) ON DELETE CASCADE,  -- Detalle de reserva
    status VARCHAR2(20) DEFAULT 'CONFIRMADA' CHECK (status IN ('CONFIRMADA', 'CANCELADA', 'PENDIENTE'))  -- Estado de la reserva
);
```

## Resumen

Este esquema de base de datos permite gestionar diversos aspectos de un restaurante, incluyendo:

- **Clientes y Empleados**: A través de la tabla `person`, se puede identificar y gestionar tanto a clientes como a empleados.
- **Menú**: La tabla `menu` facilita la administración de los platos ofrecidos, sus precios y descripciones.
- **Órdenes**: Las tablas `orders` y `order_detail` permiten gestionar las órdenes de los clientes, asegurando un seguimiento detallado de cada pedido.
- **Mesas**: La tabla `tables` ayuda a gestionar la disponibilidad de las mesas en el restaurante.
- **Reservas**: Las tablas `reservations` y `reservation_detail` permiten gestionar las reservas de los clientes, asegurando una planificación efectiva.

Este diseño estructurado no solo facilita las operaciones diarias del restaurante, sino que también asegura la integridad y consistencia de los datos almacenados. Si necesitas más información o ajustes, no dudes en decírmelo.
